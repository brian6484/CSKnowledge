{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "type": "text",
      "version": 481,
      "versionNonce": 2125465469,
      "isDeleted": false,
      "id": "VyJw-9UnVO85Ai-VUsjAZ",
      "fillStyle": "cross-hatch",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "angle": 0,
      "x": 242.4453125,
      "y": 130.71484375,
      "strokeColor": "#000000",
      "backgroundColor": "#fff",
      "width": 665.927734375,
      "height": 46,
      "seed": 896043666,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 36,
      "fontFamily": 1,
      "text": "Design Facebook Messenger/WhatsApp",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "Design Facebook Messenger/WhatsApp",
      "lineHeight": 1.2777777777777777,
      "index": "a0",
      "autoResize": true
    },
    {
      "type": "text",
      "version": 2750,
      "versionNonce": 164887251,
      "isDeleted": false,
      "id": "rJNp2O8hJaAFg3kMyMk_Z",
      "fillStyle": "cross-hatch",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 256.9455431472643,
      "y": 194.6240890310795,
      "strokeColor": "#000",
      "backgroundColor": "#000",
      "width": 33,
      "height": 45,
      "seed": 967341710,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 33.23791410279167,
      "fontFamily": 1,
      "text": "✨",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "✨",
      "lineHeight": 1.3538755729626375,
      "index": "a1",
      "autoResize": true
    },
    {
      "type": "text",
      "version": 3553,
      "versionNonce": 698093533,
      "isDeleted": false,
      "id": "vqMVltV12q_NqgH7tTBfp",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 303.89692337950237,
      "y": 206.90406208017828,
      "strokeColor": "#495057",
      "backgroundColor": "#fff",
      "width": 186.1759033203125,
      "height": 20,
      "seed": 582382798,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 16,
      "fontFamily": 1,
      "text": "Functional Requirements",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "Functional Requirements",
      "lineHeight": 1.25,
      "index": "a2",
      "autoResize": true
    },
    {
      "type": "line",
      "version": 1839,
      "versionNonce": 1507010675,
      "isDeleted": false,
      "id": "2GWYHE69MwgPJSZdMMqHq",
      "fillStyle": "hachure",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 257.6696328691687,
      "y": 242.08984497835934,
      "strokeColor": "#000000",
      "backgroundColor": "transparent",
      "width": 165.2005648542745,
      "height": 0.8295616012067057,
      "seed": 770353934,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "startBinding": null,
      "endBinding": null,
      "lastCommittedPoint": null,
      "startArrowhead": null,
      "endArrowhead": null,
      "points": [
        [
          0,
          0
        ],
        [
          165.2005648542745,
          0.8295616012067057
        ]
      ],
      "index": "a3",
      "polygon": false
    },
    {
      "type": "text",
      "version": 1977,
      "versionNonce": 1051200573,
      "isDeleted": false,
      "id": "iIdO4f73th-8rX4KYwiIm",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 0,
      "opacity": 100,
      "angle": 0,
      "x": 264.75891966469817,
      "y": 261.45353346486024,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#fefefe",
      "width": 428.9596252441406,
      "height": 200,
      "seed": 700324174,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 20,
      "fontFamily": 1,
      "text": "1. Support group chats with up to 10 users\n2. Sending messages\n3. Receive messages in real time\n4. Persist messages so that users can\naccess them from other devices/load other\nconversations\n5. support other devices and media types (\ntext, media, img, vid)",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "1. Support group chats with up to 10 users\n2. Sending messages\n3. Receive messages in real time\n4. Persist messages so that users can\naccess them from other devices/load other\nconversations\n5. support other devices and media types (\ntext, media, img, vid)",
      "lineHeight": 1.25,
      "index": "a4",
      "autoResize": true
    },
    {
      "type": "rectangle",
      "version": 2442,
      "versionNonce": 1759224339,
      "isDeleted": false,
      "id": "m-EddKns-1R41v_YIRSCg",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 250.90134776616696,
      "y": 190.4848260003704,
      "strokeColor": "#495057",
      "backgroundColor": "transparent",
      "width": 472.07621071766613,
      "height": 253.04987924925925,
      "seed": 764002190,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "index": "a5"
    },
    {
      "type": "text",
      "version": 6079,
      "versionNonce": 1572175005,
      "isDeleted": false,
      "id": "es-dVSBh_mMs5UJW248CZ",
      "fillStyle": "hachure",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "angle": 0,
      "x": 739.9860620920408,
      "y": 257.8268981076844,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "width": 467.4195556640625,
      "height": 494,
      "seed": 887144462,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 20,
      "fontFamily": 1,
      "text": "calc:\n1. 1 bil total users\n2. Each user sends 100 messages a day\n3. Each message is around 100 bytes\n4. 1 bil * 100 msgs * 100 bytes = 10^13 bytes\n= 10 TB of write/day\nif read:write is 2:1, 20TB of read/day\n\ncap theorem:\nconsistency = all users see SAME data at\nsame time across all servers\n\nAP with eventual consistency is better. Users\nexpect to send & receive messages even with \nnetwork issue and its ok to show slightly stale\ndata than block messaging entirely\n\nbtw strong consistency: r+w > n\n",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "calc:\n1. 1 bil total users\n2. Each user sends 100 messages a day\n3. Each message is around 100 bytes\n4. 1 bil * 100 msgs * 100 bytes = 10^13 bytes\n= 10 TB of write/day\nif read:write is 2:1, 20TB of read/day\n\ncap theorem:\nconsistency = all users see SAME data at\nsame time across all servers\n\nAP with eventual consistency is better. Users\nexpect to send & receive messages even with \nnetwork issue and its ok to show slightly stale\ndata than block messaging entirely\n\nbtw strong consistency: r+w > n\n",
      "lineHeight": 1.3,
      "index": "a6",
      "autoResize": true
    },
    {
      "type": "text",
      "version": 4488,
      "versionNonce": 535029683,
      "isDeleted": false,
      "id": "Cw43clLeqn0rfJoDKy3Mf",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 784.4051289447384,
      "y": 201.18216987458527,
      "strokeColor": "#495057",
      "backgroundColor": "#fff",
      "width": 215.43988037109375,
      "height": 20,
      "seed": 1932103246,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 16,
      "fontFamily": 1,
      "text": "Non functional requirements",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "Non functional requirements",
      "lineHeight": 1.25,
      "index": "a7",
      "autoResize": true
    },
    {
      "type": "line",
      "version": 2645,
      "versionNonce": 779477245,
      "isDeleted": false,
      "id": "NeA7LWd6grc004a60g4rj",
      "fillStyle": "hachure",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 736.6079796031318,
      "y": 240.22947912111067,
      "strokeColor": "#000000",
      "backgroundColor": "transparent",
      "width": 263.6620648633493,
      "height": 1.238537448047282,
      "seed": 62821518,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "startBinding": null,
      "endBinding": null,
      "lastCommittedPoint": null,
      "startArrowhead": null,
      "endArrowhead": null,
      "points": [
        [
          0,
          0
        ],
        [
          263.6620648633493,
          -1.238537448047282
        ]
      ],
      "index": "a8",
      "polygon": false
    },
    {
      "type": "rectangle",
      "version": 2979,
      "versionNonce": 85096787,
      "isDeleted": false,
      "id": "YnCrK1eaDRgJugNOfGOGz",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "angle": 0,
      "x": 727.6954151489795,
      "y": 190.82273188416093,
      "strokeColor": "#495057",
      "backgroundColor": "transparent",
      "width": 464.382607202041,
      "height": 478.40819168267234,
      "seed": 1079562958,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "index": "a9"
    },
    {
      "type": "text",
      "version": 3503,
      "versionNonce": 1718270301,
      "isDeleted": false,
      "id": "wvByBEpLA1ci8sYaPG6Av",
      "fillStyle": "cross-hatch",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 734.805833674608,
      "y": 194.07874684580474,
      "strokeColor": "#000",
      "backgroundColor": "#000",
      "width": 36,
      "height": 49.15083451704544,
      "seed": 1670465806,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 36.30380479462411,
      "fontFamily": 1,
      "text": "✉️",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "✉️",
      "lineHeight": 1.353875572962637,
      "index": "aA",
      "autoResize": true
    },
    {
      "type": "rectangle",
      "version": 3001,
      "versionNonce": 364762867,
      "isDeleted": false,
      "id": "L_ZHTbDehz_-MJZS1M6XR",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 252.52709588292237,
      "y": 679.623417100209,
      "strokeColor": "#495057",
      "backgroundColor": "transparent",
      "width": 945.3137849776634,
      "height": 1190.7143950664117,
      "seed": 124291410,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "index": "aB"
    },
    {
      "type": "text",
      "version": 3870,
      "versionNonce": 249923005,
      "isDeleted": false,
      "id": "Qr8kzSnfEQPAeLquWjnP3",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 256.9181761200852,
      "y": 651.8242943517002,
      "strokeColor": "#495057",
      "backgroundColor": "#fff",
      "width": 132.81593322753906,
      "height": 20,
      "seed": 1427102930,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 16,
      "fontFamily": 1,
      "text": "High Level Design",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "High Level Design",
      "lineHeight": 1.25,
      "index": "aD",
      "autoResize": true
    },
    {
      "type": "text",
      "version": 4029,
      "versionNonce": 1617723539,
      "isDeleted": false,
      "id": "lx2X8KGWP_0yUt_7O-27Z",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 0,
      "opacity": 100,
      "angle": 0,
      "x": 266.496407068916,
      "y": 692.5583024808944,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#fefefe",
      "width": 918.3992919921875,
      "height": 1794,
      "seed": 1083723858,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 20,
      "fontFamily": 1,
      "text": "Message read Flow:\nconsidering read volume is 20tb /day how is the read flow? we are storing messages in db \nbut i think we need to cache but 1 single redis node cant cache that much and is expensive \nso maybe a redis cluster? \n\nyes. We utilise client cache (ON THE DEVICE) that stores messages that user has **alr\nseen/loaded**. Redis stores the recent messages (like 100 per chat) and not old messages \ncuz of 80/20 rule where 20% of chats geenerate 80% of traffic\n\nUser requests messages for chat 123:\n    ↓\n1. Check client cache → 70% hit ✅\n    ↓ (if miss)\n2. Check Redis cluster → 25% hit ✅\n   - hash(chatId) → Redis node 5\n   - TTL: 1 hour for active chats \n    ↓ (if miss)\n3. Query Cassandra → 5% of reads\n   - Read from disk\n   - Populate Redis cache\n\n1. Users Database & UserChat Db\n\nWe should be able to fetch all chats for a given user.\n-> Want all chatIds for given user to be on same shard and reduce expensive cross-shard\nqueries\n-> So hash-based partition on user_id\n\nuserId | chat Id\n3      | 12\n3      | 19\n10     | 12\n10     | 65\n\ncausal dependency write conflict issue:\ncasual dependency - operations that depend on each other\n\n if 2 servers try to add different people to group chat at same time:\nServer 1 (US):                    Server 2 (EU):\nAlice adds Charlie to chat        Bob adds David to chat\nchatMembers = [Alice, Bob]        chatMembers = [Alice, Bob]\n   ↓                                 ↓\nchatMembers = [Alice, Bob, Charlie]  chatMembers = [Alice, Bob, David]\n\nWhen they sync, there is conflict.\nFor messages where there should be high throughput, we should be using vector clocks but\nsince user db isnt bottleneck, we can just use single leader replication. Single leader decides\norder then replicates to follower servers.\n\nThis DB likely not a performance bottleneck, let's just use PostgreSQL with read replicas.\nPrimary DB replicates across replicas and its asyncrhonous. There might be small data\nloss (Recovery Point Objective RPO) when theres failure. \n\n-- Table 1: User Profile\nUsers: userId (PK), email, passwordHash, name, phone, created_at\n\n-- Table 2: User-Chat Membership (might need more scalable cuz it grows with every chat).\n**Here chat means either 1-1 on chat or a group chat. It is different from message**\nlike 2 bil users x 50 chat = 100 bil rows so Cassandra)\nUserChats: userId, chatId, joined_at (to check chat history boundary), role\nOptimisation: index on both userId AND chatId - useful to see \n1) What chats is Brian in? Select chatId from user_chat where userId ='Brian'\n2) Who are the members of chat 123? \n\n\n\n\n\n",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "Message read Flow:\nconsidering read volume is 20tb /day how is the read flow? we are storing messages in db \nbut i think we need to cache but 1 single redis node cant cache that much and is expensive \nso maybe a redis cluster? \n\nyes. We utilise client cache (ON THE DEVICE) that stores messages that user has **alr\nseen/loaded**. Redis stores the recent messages (like 100 per chat) and not old messages \ncuz of 80/20 rule where 20% of chats geenerate 80% of traffic\n\nUser requests messages for chat 123:\n    ↓\n1. Check client cache → 70% hit ✅\n    ↓ (if miss)\n2. Check Redis cluster → 25% hit ✅\n   - hash(chatId) → Redis node 5\n   - TTL: 1 hour for active chats \n    ↓ (if miss)\n3. Query Cassandra → 5% of reads\n   - Read from disk\n   - Populate Redis cache\n\n1. Users Database & UserChat Db\n\nWe should be able to fetch all chats for a given user.\n-> Want all chatIds for given user to be on same shard and reduce expensive cross-shard\nqueries\n-> So hash-based partition on user_id\n\nuserId | chat Id\n3      | 12\n3      | 19\n10     | 12\n10     | 65\n\ncausal dependency write conflict issue:\ncasual dependency - operations that depend on each other\n\n if 2 servers try to add different people to group chat at same time:\nServer 1 (US):                    Server 2 (EU):\nAlice adds Charlie to chat        Bob adds David to chat\nchatMembers = [Alice, Bob]        chatMembers = [Alice, Bob]\n   ↓                                 ↓\nchatMembers = [Alice, Bob, Charlie]  chatMembers = [Alice, Bob, David]\n\nWhen they sync, there is conflict.\nFor messages where there should be high throughput, we should be using vector clocks but\nsince user db isnt bottleneck, we can just use single leader replication. Single leader decides\norder then replicates to follower servers.\n\nThis DB likely not a performance bottleneck, let's just use PostgreSQL with read replicas.\nPrimary DB replicates across replicas and its asyncrhonous. There might be small data\nloss (Recovery Point Objective RPO) when theres failure. \n\n-- Table 1: User Profile\nUsers: userId (PK), email, passwordHash, name, phone, created_at\n\n-- Table 2: User-Chat Membership (might need more scalable cuz it grows with every chat).\n**Here chat means either 1-1 on chat or a group chat. It is different from message**\nlike 2 bil users x 50 chat = 100 bil rows so Cassandra)\nUserChats: userId, chatId, joined_at (to check chat history boundary), role\nOptimisation: index on both userId AND chatId - useful to see \n1) What chats is Brian in? Select chatId from user_chat where userId ='Brian'\n2) Who are the members of chat 123? \n\n\n\n\n\n",
      "lineHeight": 1.3,
      "index": "aF",
      "autoResize": true
    },
    {
      "type": "rectangle",
      "version": 2885,
      "versionNonce": 185058845,
      "isDeleted": false,
      "id": "vTk2uaG9G4v82slfpHpPW",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 1207.858791325946,
      "y": 185.09234761333641,
      "strokeColor": "#495057",
      "backgroundColor": "transparent",
      "width": 908.4307242809056,
      "height": 1457.3983464515795,
      "seed": 880755342,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "index": "aG"
    },
    {
      "type": "text",
      "version": 2989,
      "versionNonce": 1591014963,
      "isDeleted": false,
      "id": "MTvWU4cfCExWFl-8goZE1",
      "fillStyle": "cross-hatch",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 1222.7530478827173,
      "y": 200.89206174388642,
      "strokeColor": "#000",
      "backgroundColor": "#000",
      "width": 33,
      "height": 45,
      "seed": 819183822,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 33.23791410279167,
      "fontFamily": 1,
      "text": "✨",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "✨",
      "lineHeight": 1.3538755729626375,
      "index": "aH",
      "autoResize": true
    },
    {
      "type": "text",
      "version": 3860,
      "versionNonce": 1573059197,
      "isDeleted": false,
      "id": "95udZlQmO2JlHPh8diLGX",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 1269.7044281149554,
      "y": 213.17203479298155,
      "strokeColor": "#495057",
      "backgroundColor": "#fff",
      "width": 224.19189453125,
      "height": 20,
      "seed": 578713358,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 16,
      "fontFamily": 1,
      "text": "High Level Design (continued)",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "High Level Design (continued)",
      "lineHeight": 1.25,
      "index": "aI",
      "autoResize": true
    },
    {
      "type": "line",
      "version": 2078,
      "versionNonce": 266188755,
      "isDeleted": false,
      "id": "ej_Ga2pTXng3-XhQS4i39",
      "fillStyle": "hachure",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 1223.4771376046217,
      "y": 248.3578176911626,
      "strokeColor": "#000000",
      "backgroundColor": "transparent",
      "width": 165.2005648542745,
      "height": 0.8295616012067057,
      "seed": 1912104270,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "startBinding": null,
      "endBinding": null,
      "lastCommittedPoint": null,
      "startArrowhead": null,
      "endArrowhead": null,
      "points": [
        [
          0,
          0
        ],
        [
          165.2005648542745,
          0.8295616012067057
        ]
      ],
      "index": "aJ",
      "polygon": false
    },
    {
      "type": "text",
      "version": 7393,
      "versionNonce": 37095685,
      "isDeleted": false,
      "id": "fIfpwytlFPqBfGKoOa7wC",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 0,
      "opacity": 100,
      "angle": 0,
      "x": 1220.3194017917292,
      "y": 270.07374976316714,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#fefefe",
      "width": 1088.5191650390625,
      "height": 3094,
      "seed": 278563726,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761462987394,
      "link": null,
      "locked": false,
      "fontSize": 20,
      "fontFamily": 1,
      "text": "Chat/Message DB -> Cassandra (leaderless,\nhigh write throughput, AP so meets non-functional req)\nwe can adjust Quorum for impt messages to increase consistency\nLeaderless replication = high availability (AP system) look at my github blog\n\nHBase is for CP and is leader-based but both use LSM trees that are optimised for \nwrites\n\nWe want to make sure that getting all the messages for a given chat\nis fast!\n\nSchema: chatId (partition key), timestamp (clustering key), message, metadata\n         2                     1000                      \"Hiii\"      From: Joe\n         2                     1003                      \"Yoo\"      From: Jack\n\nbut if timestamp is same like 1000 for both messages, we dk which message is earlier so\nclustering key better is (timestamp, message_id)\nMessages for chat already on same partition and pre-sorted!\nThis message id can be UUID or snowflake based UUID.\n\ncan also discuss storage vs write throughput\nfor discord, with current chatid partition key if theres a lot of messages stored in that \nsingle partition like a mil messages, then storage is high and query is gonna be v slow\nso discord uses (chat_id, bucket) as partition key, where bucket is 10 days worth of time\nfrom a starting point like Jan 1st 2015\n\nso for example\nday 0-9 after this starting point is assigned bucket 0\nday 10-19 has this bucket 1 value and soonb\n\nso even the busiest chat group with 10 days of messages fits comfortably in 1 cassandra\npartition. So it isolve the partion becoming too big where it might be millions of messages\nin that partition and read/write performance degrades as this data grows. Then I was \nwondering wont this make the partition **too hot**? cuz all writes go to 1 partition? \nso this write throughput issue is much less sever than years of write (data storage) and\ncass can handle w throughput well but its the reading from giant parittions that kills \nperformacnce\n\nthere will be some occassion cross-shard queries like if somebody sends a message on day\n9 which goes to bucket 0 and someone replies at day 11, then we need to query both \npartitions to show recent messages but this is minor compared to improving the storage\nand read performance of queries\n\nDont say lets choose Cassandra right away! Discuss!\nShould we optimise for read/write?\n1) r:w is 2:1 but most reads are recent messages so its write-heavy workload\n2) choose between B-tree based db (postgresql) that is optimised for reads VS\nLSM-tree based db (Cassandra) that is optimised for writes\n3) LSm trees are fast cuz writes go to in-memory DS called MemTable then flushed to\ndisk sequentially so theres no random i/o. This is faster than B-tree that needs random\ndisk access to update tree nodes. \n\nBut trade-off is reads are slightly slower but we can optimise by caching recent messages\nin Redis or using bloom filter to quickly skip files that dont have this key. Cuz since most\nreads are for recent messages.\n\nfor update/delete, Cass is **APPEND ONLY**db so it never edits existing rows on disk.\nIt creates a new record.\nUpdate: just writes a new column value with timestamp and during read, the column with \nnewst timestamp overwrites the older one\nDelete: marks the record with a tombstone - and during compaction, Cass merges\noverlapping SSTables and removes tombstoned rows if grace period expired\n\nso for message persistence:\n1. Client sends message to Chat Server via WebSocket\n2. Chat Server assigns UUID and writes to Kafka (partitioned by chatId)\n3. Kafka consumer writes to Cassandra for persistence and Index in ES and analytics as optional consumers\n4. We use Kafka as a buffer to handle spikes and decouple \n   storage from routing\n\nMessage Routing: \n1. Chat Server queries Connection Service: 'Where are recipients?'\n2. Connection Service (Redis) returns:\n   - Bob is on Chat Server B\n   - Charlie is on Chat Server C\n   - David is offline\n3. Chat Server publishes to internal message queue/Kafka topic\n4. Recipient servers receive and push via WebSocket\n5. For offline users, we:\n   - Send push notification via FCM\n   - Store message in Cassandra\n   - Deliver when they reconnect\n\n(discuss push vs pull)\n1) push: fanout from message service\nmessage service queries connection service and sends to all receipient chat servers\n2) pull: for large groups\nwrites to Cass first and receipients poll for new messages OR use FCM for notif\n3) hybrid: <10 or 1 on 1 we use push via websocket and for large groups we do notif + pull\n\nChat server -> connection service (redis that maps userId -> chatServerId) gets\nreceipient locations-> Kafka -> Recipient chat servers -> websocket push to clients\n                                                      -> if offline, push notification (fcm) \n                                                          + store in Cassandra\n\nCONNECTION ESTABLISHMENT:\n1. Client connects through Layer 4 TCP load balancer\n2. LB routes to least-loaded chat server using health checks\n3. Chat server accepts WebSocket connection\n4. Server registers user in Redis: userId → serverId\n5. Client sends heartbeat every 30s to keep connection alive\n\nHEALTH MONITORING:\n1. Each chat server creates ephemeral node in ZooKeeper\n2. Sends heartbeat every 5-10 seconds\n3. If server crashes, ZooKeeper auto-deletes the node\n4. Load balancer watches ZooKeeper and updates routing\n\nFAILOVER:\n1. Server crashes → WebSocket breaks\n2. Client detects broken connection\n3. Reconnects with exponential backoff + jitter:\n   - First retry: 1s + random(0-1s)\n   - Second retry: 2s + random(0-1s)\n   - Max: 30s + jitter\n4. Jitter prevents thundering herd if thousands reconnect\n5. LB routes to healthy server\n6. Redis updated with new serverId\n",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "Chat/Message DB -> Cassandra (leaderless,\nhigh write throughput, AP so meets non-functional req)\nwe can adjust Quorum for impt messages to increase consistency\nLeaderless replication = high availability (AP system) look at my github blog\n\nHBase is for CP and is leader-based but both use LSM trees that are optimised for \nwrites\n\nWe want to make sure that getting all the messages for a given chat\nis fast!\n\nSchema: chatId (partition key), timestamp (clustering key), message, metadata\n         2                     1000                      \"Hiii\"      From: Joe\n         2                     1003                      \"Yoo\"      From: Jack\n\nbut if timestamp is same like 1000 for both messages, we dk which message is earlier so\nclustering key better is (timestamp, message_id)\nMessages for chat already on same partition and pre-sorted!\nThis message id can be UUID or snowflake based UUID.\n\ncan also discuss storage vs write throughput\nfor discord, with current chatid partition key if theres a lot of messages stored in that \nsingle partition like a mil messages, then storage is high and query is gonna be v slow\nso discord uses (chat_id, bucket) as partition key, where bucket is 10 days worth of time\nfrom a starting point like Jan 1st 2015\n\nso for example\nday 0-9 after this starting point is assigned bucket 0\nday 10-19 has this bucket 1 value and soonb\n\nso even the busiest chat group with 10 days of messages fits comfortably in 1 cassandra\npartition. So it isolve the partion becoming too big where it might be millions of messages\nin that partition and read/write performance degrades as this data grows. Then I was \nwondering wont this make the partition **too hot**? cuz all writes go to 1 partition? \nso this write throughput issue is much less sever than years of write (data storage) and\ncass can handle w throughput well but its the reading from giant parittions that kills \nperformacnce\n\nthere will be some occassion cross-shard queries like if somebody sends a message on day\n9 which goes to bucket 0 and someone replies at day 11, then we need to query both \npartitions to show recent messages but this is minor compared to improving the storage\nand read performance of queries\n\nDont say lets choose Cassandra right away! Discuss!\nShould we optimise for read/write?\n1) r:w is 2:1 but most reads are recent messages so its write-heavy workload\n2) choose between B-tree based db (postgresql) that is optimised for reads VS\nLSM-tree based db (Cassandra) that is optimised for writes\n3) LSm trees are fast cuz writes go to in-memory DS called MemTable then flushed to\ndisk sequentially so theres no random i/o. This is faster than B-tree that needs random\ndisk access to update tree nodes. \n\nBut trade-off is reads are slightly slower but we can optimise by caching recent messages\nin Redis or using bloom filter to quickly skip files that dont have this key. Cuz since most\nreads are for recent messages.\n\nfor update/delete, Cass is **APPEND ONLY**db so it never edits existing rows on disk.\nIt creates a new record.\nUpdate: just writes a new column value with timestamp and during read, the column with \nnewst timestamp overwrites the older one\nDelete: marks the record with a tombstone - and during compaction, Cass merges\noverlapping SSTables and removes tombstoned rows if grace period expired\n\nso for message persistence:\n1. Client sends message to Chat Server via WebSocket\n2. Chat Server assigns UUID and writes to Kafka (partitioned by chatId)\n3. Kafka consumer writes to Cassandra for persistence and Index in ES and analytics as optional consumers\n4. We use Kafka as a buffer to handle spikes and decouple \n   storage from routing\n\nMessage Routing: \n1. Chat Server queries Connection Service: 'Where are recipients?'\n2. Connection Service (Redis) returns:\n   - Bob is on Chat Server B\n   - Charlie is on Chat Server C\n   - David is offline\n3. Chat Server publishes to internal message queue/Kafka topic\n4. Recipient servers receive and push via WebSocket\n5. For offline users, we:\n   - Send push notification via FCM\n   - Store message in Cassandra\n   - Deliver when they reconnect\n\n(discuss push vs pull)\n1) push: fanout from message service\nmessage service queries connection service and sends to all receipient chat servers\n2) pull: for large groups\nwrites to Cass first and receipients poll for new messages OR use FCM for notif\n3) hybrid: <10 or 1 on 1 we use push via websocket and for large groups we do notif + pull\n\nChat server -> connection service (redis that maps userId -> chatServerId) gets\nreceipient locations-> Kafka -> Recipient chat servers -> websocket push to clients\n                                                      -> if offline, push notification (fcm) \n                                                          + store in Cassandra\n\nCONNECTION ESTABLISHMENT:\n1. Client connects through Layer 4 TCP load balancer\n2. LB routes to least-loaded chat server using health checks\n3. Chat server accepts WebSocket connection\n4. Server registers user in Redis: userId → serverId\n5. Client sends heartbeat every 30s to keep connection alive\n\nHEALTH MONITORING:\n1. Each chat server creates ephemeral node in ZooKeeper\n2. Sends heartbeat every 5-10 seconds\n3. If server crashes, ZooKeeper auto-deletes the node\n4. Load balancer watches ZooKeeper and updates routing\n\nFAILOVER:\n1. Server crashes → WebSocket breaks\n2. Client detects broken connection\n3. Reconnects with exponential backoff + jitter:\n   - First retry: 1s + random(0-1s)\n   - Second retry: 2s + random(0-1s)\n   - Max: 30s + jitter\n4. Jitter prevents thundering herd if thousands reconnect\n5. LB routes to healthy server\n6. Redis updated with new serverId\n",
      "lineHeight": 1.3,
      "index": "aK",
      "autoResize": true
    },
    {
      "type": "rectangle",
      "version": 2725,
      "versionNonce": 1369261427,
      "isDeleted": false,
      "id": "44wIU1UkgC1js8WhWZxWG",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 2144.9226645709246,
      "y": 190.80282037661186,
      "strokeColor": "#495057",
      "backgroundColor": "transparent",
      "width": 908.4307242809056,
      "height": 519.7782190225288,
      "seed": 436609234,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "index": "aL"
    },
    {
      "type": "text",
      "version": 3937,
      "versionNonce": 366624573,
      "isDeleted": false,
      "id": "6SoxsTZp_by84FMyTVjaw",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 2193.563148461356,
      "y": 207.87179697466905,
      "strokeColor": "#495057",
      "backgroundColor": "#fff",
      "width": 224.19189453125,
      "height": 20,
      "seed": 1652741010,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 16,
      "fontFamily": 1,
      "text": "High Level Design (continued)",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "High Level Design (continued)",
      "lineHeight": 1.25,
      "index": "aM",
      "autoResize": true
    },
    {
      "type": "text",
      "version": 3093,
      "versionNonce": 2069503763,
      "isDeleted": false,
      "id": "Oum6vKNp_q3RziJ4X-I82",
      "fillStyle": "cross-hatch",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 2154.0239311549963,
      "y": 199.28751814749143,
      "strokeColor": "#000",
      "backgroundColor": "#000",
      "width": 33,
      "height": 45,
      "seed": 1123454162,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "fontSize": 33.23791410279167,
      "fontFamily": 1,
      "text": "✨",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "✨",
      "lineHeight": 1.3538755729626375,
      "index": "aN",
      "autoResize": true
    },
    {
      "type": "line",
      "version": 2217,
      "versionNonce": 371806109,
      "isDeleted": false,
      "id": "LC9mZJKR0N0ipq9YUY9_u",
      "fillStyle": "hachure",
      "strokeWidth": 1,
      "strokeStyle": "solid",
      "roughness": 2,
      "opacity": 100,
      "angle": 0,
      "x": 2154.7480208769007,
      "y": 246.75327409476756,
      "strokeColor": "#000000",
      "backgroundColor": "transparent",
      "width": 266.29623855597583,
      "height": 0.8295616012067057,
      "seed": 703668882,
      "groupIds": [],
      "frameId": null,
      "roundness": {
        "type": 2
      },
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "startBinding": null,
      "endBinding": null,
      "lastCommittedPoint": null,
      "startArrowhead": null,
      "endArrowhead": null,
      "points": [
        [
          0,
          0
        ],
        [
          266.29623855597583,
          0.8295616012067057
        ]
      ],
      "index": "aO",
      "polygon": false
    },
    {
      "type": "text",
      "version": 1481,
      "versionNonce": 339793733,
      "isDeleted": false,
      "id": "MRV16jbnCUJPBXMX5Q_93",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "angle": 0,
      "x": 2157.1248443391355,
      "y": 254.4827302974909,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "width": 901.0592651367188,
      "height": 400,
      "seed": 512095950,
      "groupIds": [],
      "frameId": null,
      "roundness": null,
      "boundElements": [],
      "updated": 1761462561290,
      "link": null,
      "locked": false,
      "fontSize": 20,
      "fontFamily": 1,
      "text": "Connection Service:\nmapping of userId -> chatServerId in Redis and is updated when user connects/disconnects\n\nDetect users if online/offline:\nWhen user opens app, establishes WS connection. WS server stores Redis of\nuserId -> (server_id,connection_id,timestamp,status)\nif there is userId in redis, that means timestamp is recent. \nWhen user goes offline, websocket server detect disconnection and redis can either delete\nthat record for that userId or set status as offline\n\nclient can also send occasional heartbeat to server to keep websocket alive.\n\n\n\n\n",
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "Connection Service:\nmapping of userId -> chatServerId in Redis and is updated when user connects/disconnects\n\nDetect users if online/offline:\nWhen user opens app, establishes WS connection. WS server stores Redis of\nuserId -> (server_id,connection_id,timestamp,status)\nif there is userId in redis, that means timestamp is recent. \nWhen user goes offline, websocket server detect disconnection and redis can either delete\nthat record for that userId or set status as offline\n\nclient can also send occasional heartbeat to server to keep websocket alive.\n\n\n\n\n",
      "lineHeight": 1.25,
      "index": "aP",
      "autoResize": true
    },
    {
      "id": "oEHx_IVuFTVLBt3sCMmaX",
      "type": "rectangle",
      "x": 2323.966428312635,
      "y": 1092.3695561748002,
      "width": 234.66671413845506,
      "height": 107.5556098090276,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aR",
      "roundness": {
        "type": 3
      },
      "seed": 740933299,
      "version": 38,
      "versionNonce": 1861702653,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "5by_by7dVUMQfIcpvd8W5"
        },
        {
          "id": "uSXuCPiNJITEQma0GNwLo",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "5by_by7dVUMQfIcpvd8W5",
      "type": "text",
      "x": 2351.209850079128,
      "y": 1133.6473610793141,
      "width": 180.17987060546875,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aS",
      "roundness": null,
      "seed": 412944179,
      "version": 25,
      "versionNonce": 500545107,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "client sends \"hello\"",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "oEHx_IVuFTVLBt3sCMmaX",
      "originalText": "client sends \"hello\"",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "rBGsLh8jLvqBS9HKbL4sD",
      "type": "rectangle",
      "x": 2744.4109337922355,
      "y": 1073.7028691630815,
      "width": 304.00004069010447,
      "height": 157.33334011501734,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aT",
      "roundness": {
        "type": 3
      },
      "seed": 600187997,
      "version": 98,
      "versionNonce": 474336349,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "0QRnr-Tm3zE0iZTmWwnaK"
        },
        {
          "id": "uSXuCPiNJITEQma0GNwLo",
          "type": "arrow"
        },
        {
          "id": "-_KExc5VvedE8ykXZ4GQ6",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "0QRnr-Tm3zE0iZTmWwnaK",
      "type": "text",
      "x": 2779.7510420279127,
      "y": 1127.36953922059,
      "width": 233.31982421875,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aTV",
      "roundness": null,
      "seed": 2112979581,
      "version": 44,
      "versionNonce": 219247603,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Chat Server (websocket\nconnection)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "rBGsLh8jLvqBS9HKbL4sD",
      "originalText": "Chat Server (websocket connection)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "YhGa1XYyyQnbDnB16507z",
      "type": "rectangle",
      "x": 3331.280703176226,
      "y": 1039.6330180597984,
      "width": 374.66664632161473,
      "height": 178.66668701171875,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aU",
      "roundness": {
        "type": 3
      },
      "seed": 784032563,
      "version": 88,
      "versionNonce": 501627069,
      "isDeleted": false,
      "boundElements": [
        {
          "id": "-_KExc5VvedE8ykXZ4GQ6",
          "type": "arrow"
        },
        {
          "type": "text",
          "id": "n5WkHrxszWzrcSu-roYCZ"
        },
        {
          "id": "SxBVY5AJgJaD_sFGFhKAo",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "n5WkHrxszWzrcSu-roYCZ",
      "type": "text",
      "x": 3389.6941349796116,
      "y": 1103.9663615656577,
      "width": 257.83978271484375,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aUV",
      "roundness": null,
      "seed": 1943074877,
      "version": 68,
      "versionNonce": 1162116499,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Kafka (topic:messages and\npartitioned by chatId)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "YhGa1XYyyQnbDnB16507z",
      "originalText": "Kafka (topic:messages and partitioned by chatId)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "uSXuCPiNJITEQma0GNwLo",
      "type": "arrow",
      "x": 2567.280713348752,
      "y": 1150.299674553939,
      "width": 157.33332316080714,
      "height": 1.33336385091161,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aW",
      "roundness": {
        "type": 2
      },
      "seed": 984807069,
      "version": 41,
      "versionNonce": 2105153821,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          157.33332316080714,
          1.33336385091161
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "oEHx_IVuFTVLBt3sCMmaX",
        "focus": 0.05631789874592236,
        "gap": 8.647570897662263
      },
      "endBinding": {
        "elementId": "rBGsLh8jLvqBS9HKbL4sD",
        "focus": -0.008998063463294506,
        "gap": 19.796897282676127
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "-_KExc5VvedE8ykXZ4GQ6",
      "type": "arrow",
      "x": 3068.6140771996634,
      "y": 1146.299684726465,
      "width": 240,
      "height": 0,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aX",
      "roundness": {
        "type": 2
      },
      "seed": 1433890717,
      "version": 37,
      "versionNonce": 1101353779,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          240,
          0
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "rBGsLh8jLvqBS9HKbL4sD",
        "focus": -0.07715916397233798,
        "gap": 20.203102717323418
      },
      "endBinding": {
        "elementId": "YhGa1XYyyQnbDnB16507z",
        "focus": -0.1940297147802393,
        "gap": 22.6666259765625
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "C2V2L9wUTQNdAalg-2iKo",
      "type": "rectangle",
      "x": 3940.6140975447156,
      "y": 1030.2996745539392,
      "width": 365.33325195312545,
      "height": 186.66666666666652,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aY",
      "roundness": {
        "type": 3
      },
      "seed": 1880822515,
      "version": 107,
      "versionNonce": 343076221,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "f8diCYi5UPN_YUQJjv1ad"
        },
        {
          "id": "SxBVY5AJgJaD_sFGFhKAo",
          "type": "arrow"
        },
        {
          "id": "XY8H7GY-Tii2vnwBOam5y",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "f8diCYi5UPN_YUQJjv1ad",
      "type": "text",
      "x": 3980.290824839638,
      "y": 1073.6330078872725,
      "width": 285.97979736328125,
      "height": 100,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aZ",
      "roundness": null,
      "seed": 1856449171,
      "version": 90,
      "versionNonce": 1385854163,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Consumer groups\n1) write to cass\n2) index in ES and anlytics is\noptional",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "C2V2L9wUTQNdAalg-2iKo",
      "originalText": "Consumer groups\n1) write to cass\n2) index in ES and anlytics is optional",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "cL2H2NVeRRVo4QKU4tvwY",
      "type": "rectangle",
      "x": 4491.280804901486,
      "y": 1030.2997254165693,
      "width": 380,
      "height": 186.66664123535156,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aa",
      "roundness": {
        "type": 3
      },
      "seed": 1091894493,
      "version": 39,
      "versionNonce": 303183325,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "un2wpXlSxSUHiSPENO4R0"
        },
        {
          "id": "XY8H7GY-Tii2vnwBOam5y",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "un2wpXlSxSUHiSPENO4R0",
      "type": "text",
      "x": 4638.960843353634,
      "y": 1111.1330460342451,
      "width": 84.63992309570312,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ab",
      "roundness": null,
      "seed": 1880438355,
      "version": 12,
      "versionNonce": 2008703603,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Cass DB",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "cL2H2NVeRRVo4QKU4tvwY",
      "originalText": "Cass DB",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "SxBVY5AJgJaD_sFGFhKAo",
      "type": "arrow",
      "x": 3715.2807438663294,
      "y": 1142.299669467676,
      "width": 213.33333333333303,
      "height": 11.999944051106695,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ac",
      "roundness": {
        "type": 2
      },
      "seed": 898130045,
      "version": 33,
      "versionNonce": 1097429565,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          213.33333333333303,
          -11.999944051106695
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "YhGa1XYyyQnbDnB16507z",
        "focus": 0.2442732079724198,
        "gap": 9.333394368488825
      },
      "endBinding": {
        "elementId": "C2V2L9wUTQNdAalg-2iKo",
        "focus": 0.04134061624414657,
        "gap": 12.000020345053144
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "XY8H7GY-Tii2vnwBOam5y",
      "type": "arrow",
      "x": 4325.9474512231,
      "y": 1135.6330028010093,
      "width": 150.66670735677053,
      "height": 0,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ad",
      "roundness": {
        "type": 2
      },
      "seed": 1890033661,
      "version": 33,
      "versionNonce": 2043386899,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          150.66670735677053,
          0
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "C2V2L9wUTQNdAalg-2iKo",
        "focus": 0.12857137407574615,
        "gap": 20.0001017252589
      },
      "endBinding": {
        "elementId": "cL2H2NVeRRVo4QKU4tvwY",
        "focus": -0.12857098287459026,
        "gap": 14.66664632161519
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "slsvlo0wZQpsWDEN8T2Re",
      "type": "rectangle",
      "x": 3471.0143050642473,
      "y": 1610.832898023991,
      "width": 378.66658528645803,
      "height": 217.33332316080737,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ae",
      "roundness": {
        "type": 3
      },
      "seed": 29106045,
      "version": 383,
      "versionNonce": 257565341,
      "isDeleted": false,
      "boundElements": [
        {
          "id": "bYdszSdQaoza1xYAj3_zu",
          "type": "text"
        },
        {
          "id": "8ck2v7mK2ccJUVZo7Yt2Y",
          "type": "arrow"
        },
        {
          "id": "0Eo1SfIFC2GHemtPC4G7E",
          "type": "arrow"
        },
        {
          "id": "hkg59O8U83K3GBi42XT5r",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "bYdszSdQaoza1xYAj3_zu",
      "type": "text",
      "x": 3482.2577386986873,
      "y": 1644.4995596043946,
      "width": 356.1797180175781,
      "height": 150,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "af",
      "roundness": null,
      "seed": 220124499,
      "version": 489,
      "versionNonce": 1153737139,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Connection Service (not for message\npersistence but for message routing\nand asking \"where are my\nreceipients\"?)\n- returns Brian is in Chat Server A\nand others too7",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "slsvlo0wZQpsWDEN8T2Re",
      "originalText": "Connection Service (not for message persistence but for message routing and asking \"where are my receipients\"?)\n- returns Brian is in Chat Server A and others too7",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "qB_-d6HKztvipt5nt99eA",
      "type": "rectangle",
      "x": 2347.280815074014,
      "y": 964.9663208755534,
      "width": 260.0000508626299,
      "height": 69.33334350585926,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aj",
      "roundness": {
        "type": 3
      },
      "seed": 656237949,
      "version": 33,
      "versionNonce": 1351993085,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "5n9ikfDGCdhTTKFyvzexq"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "5n9ikfDGCdhTTKFyvzexq",
      "type": "text",
      "x": 2359.9209467065007,
      "y": 987.132992628483,
      "width": 234.71978759765625,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ak",
      "roundness": null,
      "seed": 455594973,
      "version": 28,
      "versionNonce": 30143315,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "for message persistence",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "qB_-d6HKztvipt5nt99eA",
      "originalText": "for message persistence",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "GwqdwCbQGe_Ku3M3fYdPP",
      "type": "rectangle",
      "x": 2890.214195200967,
      "y": 1413.4997376236001,
      "width": 273.33333333333303,
      "height": 93.33333333333348,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "al",
      "roundness": {
        "type": 3
      },
      "seed": 1334127699,
      "version": 80,
      "versionNonce": 1201528669,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "SNv4subvXXJAatKf0kUZT"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "SNv4subvXXJAatKf0kUZT",
      "type": "text",
      "x": 2925.8709360253483,
      "y": 1447.6664042902669,
      "width": 202.0198516845703,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "am",
      "roundness": null,
      "seed": 352248659,
      "version": 60,
      "versionNonce": 1899499763,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "for message routing ",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "GwqdwCbQGe_Ku3M3fYdPP",
      "originalText": "for message routing ",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "VEq9rJom6FVDXHhUGVCaX",
      "type": "rectangle",
      "x": 2952.3475163272687,
      "y": 1652.1663805543728,
      "width": 304.00004069010447,
      "height": 157.33334011501734,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "an",
      "roundness": {
        "type": 3
      },
      "seed": 1118507837,
      "version": 259,
      "versionNonce": 1791224765,
      "isDeleted": false,
      "boundElements": [
        {
          "id": "-bnpxrT0MfaclKwerzrAL",
          "type": "text"
        },
        {
          "id": "8ck2v7mK2ccJUVZo7Yt2Y",
          "type": "arrow"
        },
        {
          "id": "0Eo1SfIFC2GHemtPC4G7E",
          "type": "arrow"
        },
        {
          "id": "0REx2eoKa0A3c-SPbGGsd",
          "type": "arrow"
        },
        {
          "id": "icozHc_RzAdsg5Kehqljp",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "-bnpxrT0MfaclKwerzrAL",
      "type": "text",
      "x": 2987.687624562946,
      "y": 1705.8330506118814,
      "width": 233.31982421875,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ao",
      "roundness": null,
      "seed": 431989661,
      "version": 202,
      "versionNonce": 76511891,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Chat Server (websocket\nconnection)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "VEq9rJom6FVDXHhUGVCaX",
      "originalText": "Chat Server (websocket connection)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "8ck2v7mK2ccJUVZo7Yt2Y",
      "type": "arrow",
      "x": 3265.6808496606022,
      "y": 1712.166312737533,
      "width": 193.33333333333348,
      "height": 13.333333333333712,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ap",
      "roundness": {
        "type": 2
      },
      "seed": 1444457203,
      "version": 449,
      "versionNonce": 1781099549,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          193.33333333333348,
          -13.333333333333712
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "VEq9rJom6FVDXHhUGVCaX",
        "focus": -0.08458049018337722,
        "gap": 9.333292643229015
      },
      "endBinding": {
        "elementId": "slsvlo0wZQpsWDEN8T2Re",
        "focus": 0.2838520453828095,
        "gap": 12.00012207031159
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "0Eo1SfIFC2GHemtPC4G7E",
      "type": "arrow",
      "x": 3457.6808700056545,
      "y": 1730.8329997492513,
      "width": 189.33329264322947,
      "height": 13.333333333333712,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aq",
      "roundness": {
        "type": 2
      },
      "seed": 929752307,
      "version": 468,
      "versionNonce": 948482099,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          -189.33329264322947,
          13.333333333333712
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "slsvlo0wZQpsWDEN8T2Re",
        "focus": 0.024089080431954367,
        "gap": 13.33343505859284
      },
      "endBinding": {
        "elementId": "VEq9rJom6FVDXHhUGVCaX",
        "focus": 0.2784193046236578,
        "gap": 12.00002034505178
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "5RAq573d4cXlkdxO-wjeh",
      "type": "rectangle",
      "x": 3485.6808496606022,
      "y": 1956.1663025650068,
      "width": 389.33339436848973,
      "height": 183.99998982747366,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ar",
      "roundness": {
        "type": 3
      },
      "seed": 1615352093,
      "version": 194,
      "versionNonce": 1975509117,
      "isDeleted": false,
      "boundElements": [
        {
          "id": "M7EaGvI82cRQ8sU83E8TZ",
          "type": "text"
        },
        {
          "id": "0REx2eoKa0A3c-SPbGGsd",
          "type": "arrow"
        },
        {
          "id": "NMl53L9lWTO5ZqK4EeqdQ",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "M7EaGvI82cRQ8sU83E8TZ",
      "type": "text",
      "x": 3652.8975727847883,
      "y": 2035.6662974787437,
      "width": 54.89994812011719,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "as",
      "roundness": null,
      "seed": 1095434611,
      "version": 150,
      "versionNonce": 789197267,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Kafka",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "5RAq573d4cXlkdxO-wjeh",
      "originalText": "Kafka",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "Dqzoji82bqBTN721_RJZK",
      "type": "rectangle",
      "x": 4048.3474756371643,
      "y": 1946.832857333887,
      "width": 442.6668294270835,
      "height": 196.00006103515602,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "at",
      "roundness": {
        "type": 3
      },
      "seed": 1030084627,
      "version": 196,
      "versionNonce": 1128843485,
      "isDeleted": false,
      "boundElements": [
        {
          "id": "MHOzDxCpfubwO26XdDFFk",
          "type": "text"
        },
        {
          "id": "NMl53L9lWTO5ZqK4EeqdQ",
          "type": "arrow"
        },
        {
          "id": "OQBI0X1sJZElqUHO8uRh7",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "MHOzDxCpfubwO26XdDFFk",
      "type": "text",
      "x": 4153.000989227659,
      "y": 2032.3328878514649,
      "width": 233.35980224609375,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "atV",
      "roundness": null,
      "seed": 15616275,
      "version": 168,
      "versionNonce": 153780083,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Receipient Chat Servers",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "Dqzoji82bqBTN721_RJZK",
      "originalText": "Receipient Chat Servers",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "Hy4a3VrZXKbh6-M8CKbeP",
      "type": "rectangle",
      "x": 4684.880719452269,
      "y": 1964.9663819107095,
      "width": 420,
      "height": 197.33332316080714,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "av",
      "roundness": {
        "type": 3
      },
      "seed": 682407155,
      "version": 157,
      "versionNonce": 1414899005,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "wh3Ce1vG7vpgyiJ9zXyLn"
        },
        {
          "id": "OQBI0X1sJZElqUHO8uRh7",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "wh3Ce1vG7vpgyiJ9zXyLn",
      "type": "text",
      "x": 4694.750851898558,
      "y": 2013.633043491113,
      "width": 400.2597351074219,
      "height": 100,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "aw",
      "roundness": null,
      "seed": 156249853,
      "version": 247,
      "versionNonce": 19929363,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Online or small groups? Websocket push\nto clients\nOffline or large groups: Push notif (FCM)\nand store in Cass",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "Hy4a3VrZXKbh6-M8CKbeP",
      "originalText": "Online or small groups? Websocket push to clients\nOffline or large groups: Push notif (FCM) and store in Cass",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "0REx2eoKa0A3c-SPbGGsd",
      "type": "arrow",
      "x": 3276.3472375659962,
      "y": 1789.5015352185135,
      "width": 186.66698611804395,
      "height": 225.33216350307475,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ax",
      "roundness": {
        "type": 2
      },
      "seed": 241219581,
      "version": 460,
      "versionNonce": 2085090717,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          186.66698611804395,
          225.33216350307475
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "VEq9rJom6FVDXHhUGVCaX",
        "focus": -0.5682153097048463,
        "gap": 20.94917198145645
      },
      "endBinding": {
        "elementId": "5RAq573d4cXlkdxO-wjeh",
        "focus": -0.7003845355324706,
        "gap": 22.666625976562045
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "NMl53L9lWTO5ZqK4EeqdQ",
      "type": "arrow",
      "x": 3895.0141423038317,
      "y": 2058.833004835514,
      "width": 130.66670735677144,
      "height": 1.33331298828125,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "ay",
      "roundness": {
        "type": 2
      },
      "seed": 1463482483,
      "version": 448,
      "versionNonce": 1150385843,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          130.66670735677144,
          1.33331298828125
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "5RAq573d4cXlkdxO-wjeh",
        "focus": 0.0901861302249954,
        "gap": 19.999898274739735
      },
      "endBinding": {
        "elementId": "Dqzoji82bqBTN721_RJZK",
        "focus": -0.17777233464750303,
        "gap": 22.666625976561136
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "OQBI0X1sJZElqUHO8uRh7",
      "type": "arrow",
      "x": 4503.0141219587795,
      "y": 2070.8330251805664,
      "width": 178.66678873697947,
      "height": 1.33336385091161,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "az",
      "roundness": {
        "type": 2
      },
      "seed": 1398105565,
      "version": 417,
      "versionNonce": 642857469,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          178.66678873697947,
          -1.33336385091161
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "Dqzoji82bqBTN721_RJZK",
        "focus": 0.2783839954283083,
        "gap": 11.99981689453216
      },
      "endBinding": {
        "elementId": "Hy4a3VrZXKbh6-M8CKbeP",
        "focus": -0.04265563689533206,
        "gap": 3.1998087565098103
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "bjDZ36wfn69SjsRtiu9FO",
      "type": "rectangle",
      "x": 4030.2143833926993,
      "y": 1599.6331369511963,
      "width": 349.9999237060547,
      "height": 231.0000228881836,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b00",
      "roundness": {
        "type": 3
      },
      "seed": 912216787,
      "version": 159,
      "versionNonce": 234172499,
      "isDeleted": false,
      "boundElements": [
        {
          "id": "qfLIdyI_XyJZOofa01Eib",
          "type": "text"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "qfLIdyI_XyJZOofa01Eib",
      "type": "text",
      "x": 4038.0744526676017,
      "y": 1690.1331483952881,
      "width": 334.27978515625,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b00V",
      "roundness": null,
      "seed": 621862941,
      "version": 188,
      "versionNonce": 1534259805,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "Query Connection registry (Redis)\nthat maps userId -> chatServerId",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "bjDZ36wfn69SjsRtiu9FO",
      "originalText": "Query Connection registry (Redis) that maps userId -> chatServerId",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "hkg59O8U83K3GBi42XT5r",
      "type": "arrow",
      "x": 3857.0141880802,
      "y": 1704.8331262700437,
      "width": 155.99998474121048,
      "height": 7.000007629394531,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b01",
      "roundness": {
        "type": 2
      },
      "seed": 373125395,
      "version": 379,
      "versionNonce": 2133962227,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          155.99998474121048,
          -7.000007629394531
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "slsvlo0wZQpsWDEN8T2Re",
        "focus": -0.04985934168320509,
        "gap": 7.333297729494461
      },
      "endBinding": null,
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "yE7igApMKEehxq9k-XtWM",
      "type": "rectangle",
      "x": 2576.0453966628893,
      "y": 1630.6908894664634,
      "width": 258.80007934570307,
      "height": 190.40002822875974,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b02",
      "roundness": {
        "type": 3
      },
      "seed": 1167148797,
      "version": 107,
      "versionNonce": 142515901,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "BqMUj2KZnRT_IUUGEjQt7"
        },
        {
          "id": "icozHc_RzAdsg5Kehqljp",
          "type": "arrow"
        },
        {
          "id": "j4bFrZn-APO7MOoPaldGH",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "BqMUj2KZnRT_IUUGEjQt7",
      "type": "text",
      "x": 2617.445436335741,
      "y": 1713.3909035808433,
      "width": 176,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b03",
      "roundness": null,
      "seed": 335937043,
      "version": 29,
      "versionNonce": 994932627,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "LB (level 4 tcp)",
      "fontSize": 20,
      "fontFamily": 8,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "yE7igApMKEehxq9k-XtWM",
      "originalText": "LB (level 4 tcp)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "icozHc_RzAdsg5Kehqljp",
      "type": "arrow",
      "x": 2845.645387507616,
      "y": 1719.6907750255455,
      "width": 96,
      "height": 1.60003662109375,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b04",
      "roundness": {
        "type": 2
      },
      "seed": 1595265939,
      "version": 28,
      "versionNonce": 68534045,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          96,
          1.60003662109375
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "yE7igApMKEehxq9k-XtWM",
        "focus": -0.08768626287735524,
        "gap": 10.799911499023438
      },
      "endBinding": {
        "elementId": "VEq9rJom6FVDXHhUGVCaX",
        "focus": 0.08411907908806783,
        "gap": 10.702128819652899
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "tvWHHJoJBvX8mZjZ7sRVa",
      "type": "rectangle",
      "x": 2221.645448542772,
      "y": 1639.6907750255455,
      "width": 222.39996337890625,
      "height": 182.4000244140625,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b05",
      "roundness": {
        "type": 3
      },
      "seed": 1853595005,
      "version": 48,
      "versionNonce": 1082068275,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "oC1-jGwRs-S8Bv2EGnhpE"
        },
        {
          "id": "j4bFrZn-APO7MOoPaldGH",
          "type": "arrow"
        }
      ],
      "updated": 1761199577516,
      "link": null,
      "locked": false
    },
    {
      "id": "oC1-jGwRs-S8Bv2EGnhpE",
      "type": "text",
      "x": 2277.845430232225,
      "y": 1718.3907872325767,
      "width": 110,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b06",
      "roundness": null,
      "seed": 657028733,
      "version": 17,
      "versionNonce": 1420415869,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "text": "client req",
      "fontSize": 20,
      "fontFamily": 8,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "tvWHHJoJBvX8mZjZ7sRVa",
      "originalText": "client req",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "j4bFrZn-APO7MOoPaldGH",
      "type": "arrow",
      "x": 2468.0454119216784,
      "y": 1740.4907628185142,
      "width": 97.60003662109375,
      "height": 1.60003662109375,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b07",
      "roundness": {
        "type": 2
      },
      "seed": 1230075347,
      "version": 22,
      "versionNonce": 36499155,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761199577516,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          97.60003662109375,
          1.60003662109375
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "tvWHHJoJBvX8mZjZ7sRVa",
        "focus": 0.07937318993105942,
        "gap": 24
      },
      "endBinding": {
        "elementId": "yE7igApMKEehxq9k-XtWM",
        "focus": -0.19000708449865403,
        "gap": 10.399948120117188
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "eDnW8_5Dkp8zjavL4i84E",
      "type": "rectangle",
      "x": 3090.6141977595926,
      "y": 196.19020016784668,
      "width": 1175.5600208647675,
      "height": 721.282125054811,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#ffffff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b08",
      "roundness": {
        "type": 3
      },
      "seed": 1637799997,
      "version": 67,
      "versionNonce": 1930894781,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "w-v-kfvZ0ehWtzrnpNmQs"
        }
      ],
      "updated": 1761199687340,
      "link": null,
      "locked": false
    },
    {
      "id": "w-v-kfvZ0ehWtzrnpNmQs",
      "type": "text",
      "x": 3100.8942081919763,
      "y": 456.8312626952522,
      "width": 1155,
      "height": 200,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#ffffff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b09",
      "roundness": null,
      "seed": 258916083,
      "version": 651,
      "versionNonce": 740774109,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1761200048995,
      "link": null,
      "locked": false,
      "text": "if websocket isnt allowed: we lose real-time push capability so clients must poll.\nrest api (polling) where client polls server for any new messages for set time interval.\nthis way has high request overhead so do long polling where when client makes a request, server holds\nthat request open for up to 30s. If message arrives during that window, server responds immediately but\nif no msg, server responds after timeout.\n\ncache redis becomes v impt cuz now it needs to store user_last_active, chat_latest_message. Without this,\nbillions of empty polls hit cassandra so need huge redis cluster.",
      "fontSize": 20,
      "fontFamily": 8,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "eDnW8_5Dkp8zjavL4i84E",
      "originalText": "if websocket isnt allowed: we lose real-time push capability so clients must poll.\nrest api (polling) where client polls server for any new messages for set time interval.\nthis way has high request overhead so do long polling where when client makes a request, server holds that request open for up to 30s. If message arrives during that window, server responds immediately but if no msg, server responds after timeout.\n\ncache redis becomes v impt cuz now it needs to store user_last_active, chat_latest_message. Without this, billions of empty polls hit cassandra so need huge redis cluster.",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "ufnSBEKJQLDkaoLbANBn_",
      "type": "rectangle",
      "x": 736.4900953504766,
      "y": 1685.2593096778505,
      "width": 948.1480916341145,
      "height": 768.8888549804688,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1N",
      "roundness": {
        "type": 3
      },
      "seed": 494428838,
      "version": 22,
      "versionNonce": 1604589158,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760853684587,
      "link": null,
      "locked": false
    },
    {
      "id": "Rk-2n0q-smfszsrGBIwyK",
      "type": "text",
      "x": 775.7493320041224,
      "y": 1724.5185463314963,
      "width": 879.119384765625,
      "height": 575,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1O",
      "roundness": null,
      "seed": 1122268282,
      "version": 761,
      "versionNonce": 755759546,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760854270614,
      "link": null,
      "locked": false,
      "text": "scenario: social media newsfeed\n\nclarifying questions:\ndo we have to design search function too? no\nwhat is the average post size for calculation? 2Kb\nwhat is the read:write ratio? i guess there is not as many writes compared to instagram? \n100:1\n\nbetter:\nReal-time updates nice-to-have but not critical (can refresh)\nSupport all content types\nInfinite scroll required\nUsers follow avg 500 people\nGlobal distribution, no single region >30%\n5-minute staleness acceptable for most users\n\nfunctional req:\nget personalised newsfeed based on user's social graph(followers/friends)\nsupport all content types (image, text, video, etc)\nglobal distribution and infinite scroll\ninteractions (comment,like,share)\nfeed ranking algorithm on recencu, engagement and user pref\ncontent moderation system to filter content",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "scenario: social media newsfeed\n\nclarifying questions:\ndo we have to design search function too? no\nwhat is the average post size for calculation? 2Kb\nwhat is the read:write ratio? i guess there is not as many writes compared to instagram? \n100:1\n\nbetter:\nReal-time updates nice-to-have but not critical (can refresh)\nSupport all content types\nInfinite scroll required\nUsers follow avg 500 people\nGlobal distribution, no single region >30%\n5-minute staleness acceptable for most users\n\nfunctional req:\nget personalised newsfeed based on user's social graph(followers/friends)\nsupport all content types (image, text, video, etc)\nglobal distribution and infinite scroll\ninteractions (comment,like,share)\nfeed ranking algorithm on recencu, engagement and user pref\ncontent moderation system to filter content",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "mw1btXUVSAxJ42dJTh4f-",
      "type": "rectangle",
      "x": 1723.1567620171434,
      "y": 1693.4074521745952,
      "width": 980.0000000000002,
      "height": 758.5185241699219,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1P",
      "roundness": {
        "type": 3
      },
      "seed": 1163741734,
      "version": 57,
      "versionNonce": 1164302394,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760854280425,
      "link": null,
      "locked": false
    },
    {
      "id": "SD6WfRagf65Zav_rovAEz",
      "type": "text",
      "x": 1752.6011386447476,
      "y": 1724.7037371680844,
      "width": 926.039306640625,
      "height": 650,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1Q",
      "roundness": null,
      "seed": 749862630,
      "version": 1016,
      "versionNonce": 1484776806,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760855173445,
      "link": null,
      "locked": false,
      "text": "non-functional req:\n500M DAU\nAverage user checks feed 10 times/day\nEach feed request fetches 20 posts\n100B posts stored in total\nRead:Write ratio = 100:1\n\ncalc:\nread: 2Kb * 10 * 20 * 500M = 400* 500 Gb = 200000Gb = 200Tb/day of reads\npeak pqs: 500M * 20 requests / 100ks = 100K QPS (but 2~3 times is 300K queries/s at peak\ntraffic)\nwrite: read was 10 times/day so write is 0.1 time/day? 2Kb * 0.1* 500M = 100Gb\nwrite qps = 500M*0.1 req/100k = 0.5k= 500 writes/s(but 2~3 times is 1500 writes/s at peak)\n\nCap theorem:\nAP or CP? AP with eventual consistency cuz isolated nodes should still serve read and write\nrequests and stale data (up to like 5 mins) is acceptable, rather than having a system that\ndoesnt accept reads or writes for consistency purposes\n\nLatency:\n200ms for reads\n\nAPI:\nGET /v1/feed?user_id={}&limit=20&cursor={}\nPOST /v1/posts with body(user_id, content, media_url, etc)\nPOST /v1/posts/{post_id}/like or comment or share",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "non-functional req:\n500M DAU\nAverage user checks feed 10 times/day\nEach feed request fetches 20 posts\n100B posts stored in total\nRead:Write ratio = 100:1\n\ncalc:\nread: 2Kb * 10 * 20 * 500M = 400* 500 Gb = 200000Gb = 200Tb/day of reads\npeak pqs: 500M * 20 requests / 100ks = 100K QPS (but 2~3 times is 300K queries/s at peak\ntraffic)\nwrite: read was 10 times/day so write is 0.1 time/day? 2Kb * 0.1* 500M = 100Gb\nwrite qps = 500M*0.1 req/100k = 0.5k= 500 writes/s(but 2~3 times is 1500 writes/s at peak)\n\nCap theorem:\nAP or CP? AP with eventual consistency cuz isolated nodes should still serve read and write\nrequests and stale data (up to like 5 mins) is acceptable, rather than having a system that\ndoesnt accept reads or writes for consistency purposes\n\nLatency:\n200ms for reads\n\nAPI:\nGET /v1/feed?user_id={}&limit=20&cursor={}\nPOST /v1/posts with body(user_id, content, media_url, etc)\nPOST /v1/posts/{post_id}/like or comment or share",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "lsWYwR6ahcssiLhQhewOU",
      "type": "rectangle",
      "x": 737.2308078342005,
      "y": 2508.962973821731,
      "width": 963.7037658691406,
      "height": 1022.2222391764321,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1R",
      "roundness": {
        "type": 3
      },
      "seed": 2042133690,
      "version": 74,
      "versionNonce": 1973469498,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760855182666,
      "link": null,
      "locked": false
    },
    {
      "id": "gPGLrsP-2zxbQ-_E3_R8G",
      "type": "text",
      "x": 749.8234286838101,
      "y": 2529.3334063575376,
      "width": 986.279296875,
      "height": 2200,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1S",
      "roundness": null,
      "seed": 219702758,
      "version": 5956,
      "versionNonce": 1455853818,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760860214204,
      "link": null,
      "locked": false,
      "text": "design:\nneed very high read throughput\n\nclient req -> load balancer (to distribute traffic evenly) -> user service (for authentication\nlike JWT token to be carried for any request within this newsfeed, user info/profile, etc) and\nuser db(postgresql cuz this isnt the bottleneck and very minor reads/writes or i think\ngraph database will work better to see user's nested followers/follows) \n\nfrom LB -> post service -> user graph db (get user's follower list and the relevant posts) and\npost db (very read-heavy workload, can choose between B+ tree based Db like postgres that\noffers fast reads and ranged queries or LSM tree based Db like Cassandra which is AP and\nis for high write throughput and medium performance on reads, but our read could be QPS\n300k with minimal latency so i would go with postgres with read replicas for faster reads)\n\nto minimise the client req's read latency, should redirect it to the closest edge location/DC\nso we use CDN (content distribution network) so instead of direct db lookups, we first see\nwhether the post is in CDN (cuz maybe user A is not the only one that is following Brian, there\ncould be user B or C who read Brian's posts so we can reuse the cache for A's req) ->\nonly when CDN doesnt have it then we wanna read the db\n\ni dont think theres any asynchronous read operation to be decoupled with kafka, except maybe\nanalytics or updating CDN/cache that can be done in the background with kafka\n\nfor writes, its only 1500 writes/s but still a high number so we would go with Cassandra, cuz\nit has in-memory Memtable that it can save writes to quickly and flush to Sstable in disk and\nis highly avaiable  \n\ngpt correction:\n1) client req goes to user service first to get jwt token\n2) LB and DNS routing is DIFFERNENT LAYER. if tokyo client request meta.com DNS returns \ntokyo DC like 52.194.x.x and if US client req meta.com DNS returns US DC like 52.69.x.x and thats\nlayer 1. This happens at client side where clients device/OS queries DNS.\nLayer 2 which is LB is within that region so if request hits tokyo LB, then it distributes\nto healhty API GW nodes within that region\n3) actually we dont need graph db cuz its used for complex queries like finding mutual firends or\nfriends of friends or certain hops. But newsfeed just needs 1 hop of user A's follower list. So\nwe can just use Redis cuz (100x faster for simple lookups and can scale to millions of QPS).\nWe add denormalised data into redis, which is redudant data for speed so instead of joining\ntables, we store complete lists. Theres tradeoff between storage space for read speed\n\nCassandra has multi-region replication and is AP. We can further optimise this with Bloom filter\nwhere if we wanna check if user A follows user B, if bloom filter says no then there definitely\nisnt the case so we dont even check redis or db. But if maybe, then we check redis & cass\nbut not really necessary cuz redis is already fast enuff\n\nconsistent hashing for redis nodes\n\nredis:\nuser:123:following\nuser:123:feed\n\n4)post db choice\n300k read qps will still crush postgres even with replicas. We should use redis extensively\n\nhot posts (recent) : redis/memcached (90% of reads cuz mostly we only check recent posts)\nwarm posts (1~30 days) : cassandra\ncold posts : s3, s3 glacier\n\nand i was wrong in choosing postgres cuz even tho it has faster reads, that is only for **SINGLE \nNODE**. But its distributed here so postgres with read replicas (each replica ~10K QPS max and\nsingle write leader) has replication lag, single master bottleneck and sharding complexity AND \nmulti region writes that increases latency. But with cass cluster with replicas, we can have multi\nmaster so no replication lag (any node can accept writes with eventual consistency) and no \nsingle point of failure and automatic sharding. Lastly, it supports multi-region so if 3 DC,\neach can accept reads/writes locally with cross-dc replication async.\n\nso use cache extensively with cass cluster\n\n\n5) i was wrong in saying \"cdn cuz maybe user A is not the only one that is following Brian\". CDN\ncaches STATIC content (images, vids) that is distributed globally at edge locations but NOT for\npersonlised feeds cuz every user's feed is unique. Redis stores **DYNAMIC content** that is \nregionally distributed and stores personalised user feeds. So while media content should be stored in\nCDN, user's feeds should be stored in redis cache\n\n6) feed generation start:\nso how do we generate user A's feed? push or pull or hybird? \npush: write to each follower's feed cache\nadv is when follower requests feed, can just read from cache which is fast. But writing is\nslow for celebrities with 1M followers, where u need 1 M writes. And its wasted work if user \ndoesnt check feed\n\npull: get followers and thier recent posts and merge and rank posts.\nadv is writing is fast and good for celebs but reading feed is slow cuz NEED TO COMPUTE\nEACH TIME. Theres also heavy db load cuz need to fetch follower's posts.\n\nhybrid: split users into 2 - users with <5K followers do push and else pull and when geenrating\nfeed, mix results from both",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "left",
      "verticalAlign": "top",
      "containerId": null,
      "originalText": "design:\nneed very high read throughput\n\nclient req -> load balancer (to distribute traffic evenly) -> user service (for authentication\nlike JWT token to be carried for any request within this newsfeed, user info/profile, etc) and\nuser db(postgresql cuz this isnt the bottleneck and very minor reads/writes or i think\ngraph database will work better to see user's nested followers/follows) \n\nfrom LB -> post service -> user graph db (get user's follower list and the relevant posts) and\npost db (very read-heavy workload, can choose between B+ tree based Db like postgres that\noffers fast reads and ranged queries or LSM tree based Db like Cassandra which is AP and\nis for high write throughput and medium performance on reads, but our read could be QPS\n300k with minimal latency so i would go with postgres with read replicas for faster reads)\n\nto minimise the client req's read latency, should redirect it to the closest edge location/DC\nso we use CDN (content distribution network) so instead of direct db lookups, we first see\nwhether the post is in CDN (cuz maybe user A is not the only one that is following Brian, there\ncould be user B or C who read Brian's posts so we can reuse the cache for A's req) ->\nonly when CDN doesnt have it then we wanna read the db\n\ni dont think theres any asynchronous read operation to be decoupled with kafka, except maybe\nanalytics or updating CDN/cache that can be done in the background with kafka\n\nfor writes, its only 1500 writes/s but still a high number so we would go with Cassandra, cuz\nit has in-memory Memtable that it can save writes to quickly and flush to Sstable in disk and\nis highly avaiable  \n\ngpt correction:\n1) client req goes to user service first to get jwt token\n2) LB and DNS routing is DIFFERNENT LAYER. if tokyo client request meta.com DNS returns \ntokyo DC like 52.194.x.x and if US client req meta.com DNS returns US DC like 52.69.x.x and thats\nlayer 1. This happens at client side where clients device/OS queries DNS.\nLayer 2 which is LB is within that region so if request hits tokyo LB, then it distributes\nto healhty API GW nodes within that region\n3) actually we dont need graph db cuz its used for complex queries like finding mutual firends or\nfriends of friends or certain hops. But newsfeed just needs 1 hop of user A's follower list. So\nwe can just use Redis cuz (100x faster for simple lookups and can scale to millions of QPS).\nWe add denormalised data into redis, which is redudant data for speed so instead of joining\ntables, we store complete lists. Theres tradeoff between storage space for read speed\n\nCassandra has multi-region replication and is AP. We can further optimise this with Bloom filter\nwhere if we wanna check if user A follows user B, if bloom filter says no then there definitely\nisnt the case so we dont even check redis or db. But if maybe, then we check redis & cass\nbut not really necessary cuz redis is already fast enuff\n\nconsistent hashing for redis nodes\n\nredis:\nuser:123:following\nuser:123:feed\n\n4)post db choice\n300k read qps will still crush postgres even with replicas. We should use redis extensively\n\nhot posts (recent) : redis/memcached (90% of reads cuz mostly we only check recent posts)\nwarm posts (1~30 days) : cassandra\ncold posts : s3, s3 glacier\n\nand i was wrong in choosing postgres cuz even tho it has faster reads, that is only for **SINGLE \nNODE**. But its distributed here so postgres with read replicas (each replica ~10K QPS max and\nsingle write leader) has replication lag, single master bottleneck and sharding complexity AND \nmulti region writes that increases latency. But with cass cluster with replicas, we can have multi\nmaster so no replication lag (any node can accept writes with eventual consistency) and no \nsingle point of failure and automatic sharding. Lastly, it supports multi-region so if 3 DC,\neach can accept reads/writes locally with cross-dc replication async.\n\nso use cache extensively with cass cluster\n\n\n5) i was wrong in saying \"cdn cuz maybe user A is not the only one that is following Brian\". CDN\ncaches STATIC content (images, vids) that is distributed globally at edge locations but NOT for\npersonlised feeds cuz every user's feed is unique. Redis stores **DYNAMIC content** that is \nregionally distributed and stores personalised user feeds. So while media content should be stored in\nCDN, user's feeds should be stored in redis cache\n\n6) feed generation start:\nso how do we generate user A's feed? push or pull or hybird? \npush: write to each follower's feed cache\nadv is when follower requests feed, can just read from cache which is fast. But writing is\nslow for celebrities with 1M followers, where u need 1 M writes. And its wasted work if user \ndoesnt check feed\n\npull: get followers and thier recent posts and merge and rank posts.\nadv is writing is fast and good for celebs but reading feed is slow cuz NEED TO COMPUTE\nEACH TIME. Theres also heavy db load cuz need to fetch follower's posts.\n\nhybrid: split users into 2 - users with <5K followers do push and else pull and when geenrating\nfeed, mix results from both",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "2LqAZreRDUPZv7JNtBJDA",
      "type": "rectangle",
      "x": 1916.490197075737,
      "y": 2823.7778338477724,
      "width": 303.70371500651027,
      "height": 205.92595418294286,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1U",
      "roundness": {
        "type": 3
      },
      "seed": 713993382,
      "version": 27,
      "versionNonce": 1440521574,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "y-4KXVJNFuze8X_aQ4N_g"
        },
        {
          "id": "QAOqbBOPUjHDBtrgVUFUt",
          "type": "arrow"
        },
        {
          "id": "tz-3Ri3riqnt6ftkoAoYg",
          "type": "arrow"
        },
        {
          "id": "pfs2ziBD1AdyFNPFgr5MA",
          "type": "arrow"
        },
        {
          "id": "-T-r4Q-0Q8WT6613GsQfS",
          "type": "arrow"
        }
      ],
      "updated": 1760857636427,
      "link": null,
      "locked": false
    },
    {
      "id": "y-4KXVJNFuze8X_aQ4N_g",
      "type": "text",
      "x": 1942.8421385023319,
      "y": 2914.2408109392436,
      "width": 250.9998321533203,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1V",
      "roundness": null,
      "seed": 1331843514,
      "version": 28,
      "versionNonce": 603002554,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856397187,
      "link": null,
      "locked": false,
      "text": "client request (with JWT)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "2LqAZreRDUPZv7JNtBJDA",
      "originalText": "client request (with JWT)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "IC2aNLc7Y0ciF-8N_sndR",
      "type": "rectangle",
      "x": 2418.7124871147994,
      "y": 2560.814831324986,
      "width": 307.407430013021,
      "height": 198.51852416992188,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1W",
      "roundness": {
        "type": 3
      },
      "seed": 177310630,
      "version": 33,
      "versionNonce": 1222971750,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "rqe7qiVbAgyNMikpLHwe5"
        },
        {
          "id": "QAOqbBOPUjHDBtrgVUFUt",
          "type": "arrow"
        }
      ],
      "updated": 1760856666002,
      "link": null,
      "locked": false
    },
    {
      "id": "rqe7qiVbAgyNMikpLHwe5",
      "type": "text",
      "x": 2433.3963046603726,
      "y": 2635.0740934099467,
      "width": 278.039794921875,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1X",
      "roundness": null,
      "seed": 1696838138,
      "version": 69,
      "versionNonce": 1943462138,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856416310,
      "link": null,
      "locked": false,
      "text": "CDN( for static content like\nimages, videos, etc)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "IC2aNLc7Y0ciF-8N_sndR",
      "originalText": "CDN( for static content like images, videos, etc)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "ByYSlBN23UZUHOH_fbMmb",
      "type": "rectangle",
      "x": 2491.304955376518,
      "y": 2823.037045070103,
      "width": 307.40753173828125,
      "height": 198.51857503255223,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1Y",
      "roundness": {
        "type": 3
      },
      "seed": 1052445498,
      "version": 163,
      "versionNonce": 663910010,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "03i57cv5fd4Z2Pjw7pHq0"
        },
        {
          "id": "zBNo49QSXZeAQp9yN290P",
          "type": "arrow"
        },
        {
          "id": "_IbxMmcmEhr_8xcA6i61O",
          "type": "arrow"
        }
      ],
      "updated": 1760857638316,
      "link": null,
      "locked": false
    },
    {
      "id": "03i57cv5fd4Z2Pjw7pHq0",
      "type": "text",
      "x": 2631.9687355889205,
      "y": 2909.7963325863793,
      "width": 26.079971313476562,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1Z",
      "roundness": null,
      "seed": 566954854,
      "version": 146,
      "versionNonce": 1218860282,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857630368,
      "link": null,
      "locked": false,
      "text": "LB",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "ByYSlBN23UZUHOH_fbMmb",
      "originalText": "LB",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "zpJ2kHDmeOu0Nh-3ex0vf",
      "type": "rectangle",
      "x": 2902.41620212131,
      "y": 2828.9630246843612,
      "width": 323.70361328125,
      "height": 186.66666666666652,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1a",
      "roundness": {
        "type": 3
      },
      "seed": 227957434,
      "version": 106,
      "versionNonce": 1686726714,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "LrL3yZZh9ef9ObmaW0bVf"
        },
        {
          "id": "zBNo49QSXZeAQp9yN290P",
          "type": "arrow"
        },
        {
          "id": "Q-OfrpPXFoH5jY4dwy3KT",
          "type": "arrow"
        }
      ],
      "updated": 1760856672293,
      "link": null,
      "locked": false
    },
    {
      "id": "LrL3yZZh9ef9ObmaW0bVf",
      "type": "text",
      "x": 2921.178103976779,
      "y": 2897.2963580176947,
      "width": 286.1798095703125,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1b",
      "roundness": null,
      "seed": 2083282342,
      "version": 41,
      "versionNonce": 1671859750,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856464250,
      "link": null,
      "locked": false,
      "text": "API GW(auth validation, rate\nlimiting)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "zpJ2kHDmeOu0Nh-3ex0vf",
      "originalText": "API GW(auth validation, rate limiting)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "bzz2224X2m81YmG_zyJCW",
      "type": "rectangle",
      "x": 3363.8977288140177,
      "y": 2827.481497991654,
      "width": 345.9260050455732,
      "height": 186.66676839192723,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1c",
      "roundness": {
        "type": 3
      },
      "seed": 743029926,
      "version": 47,
      "versionNonce": 1788779514,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "pvrRInOQWQtrU8NAGQEF6"
        },
        {
          "id": "Q-OfrpPXFoH5jY4dwy3KT",
          "type": "arrow"
        },
        {
          "id": "g279sY8aaAN5fqqp_hrqg",
          "type": "arrow"
        },
        {
          "id": "DAM-oFGJuzGIT8jh7KczK",
          "type": "arrow"
        }
      ],
      "updated": 1760856677994,
      "link": null,
      "locked": false
    },
    {
      "id": "pvrRInOQWQtrU8NAGQEF6",
      "type": "text",
      "x": 3377.2408582899293,
      "y": 2908.3148821876175,
      "width": 319.23974609375,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1cG",
      "roundness": null,
      "seed": 108988090,
      "version": 36,
      "versionNonce": 344089402,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856503131,
      "link": null,
      "locked": false,
      "text": "Feed Service (main orchestrator)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "bzz2224X2m81YmG_zyJCW",
      "originalText": "Feed Service (main orchestrator)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "jMFH4wi_djHRzAUCTJpZT",
      "type": "rectangle",
      "x": 3880.9347771538623,
      "y": 2826.000073024206,
      "width": 382.22208658854106,
      "height": 180,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1e",
      "roundness": {
        "type": 3
      },
      "seed": 842460026,
      "version": 59,
      "versionNonce": 973568038,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "_L1cK2PAFPRKlHzOqBU-S"
        },
        {
          "id": "g279sY8aaAN5fqqp_hrqg",
          "type": "arrow"
        },
        {
          "id": "nS6KJEsissFUmU9FQP6lz",
          "type": "arrow"
        }
      ],
      "updated": 1760856680439,
      "link": null,
      "locked": false
    },
    {
      "id": "_L1cK2PAFPRKlHzOqBU-S",
      "type": "text",
      "x": 3903.115949842664,
      "y": 2878.500073024206,
      "width": 337.8597412109375,
      "height": 75,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1f",
      "roundness": null,
      "seed": 1884447718,
      "version": 114,
      "versionNonce": 1812163814,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856543522,
      "link": null,
      "locked": false,
      "text": "Cache(Redis/Memcached where hit:\nreturns cached feed (~98% of\nrequests to min. db reads)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "jMFH4wi_djHRzAUCTJpZT",
      "originalText": "Cache(Redis/Memcached where hit: returns cached feed (~98% of requests to min. db reads)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "cisq4tfZBWsQYV0yJnxMb",
      "type": "rectangle",
      "x": 3898.7124871148,
      "y": 3137.111218043737,
      "width": 386.66666666666606,
      "height": 194.07399495442723,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1g",
      "roundness": {
        "type": 3
      },
      "seed": 1619913574,
      "version": 46,
      "versionNonce": 1893924646,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "YgAK20hl-o_MqoHzvB9AR"
        },
        {
          "id": "DAM-oFGJuzGIT8jh7KczK",
          "type": "arrow"
        },
        {
          "id": "sXPO5aYWvtaS9ZkPJaySR",
          "type": "arrow"
        },
        {
          "id": "ossXlN7DbWUQRmP1m1ycN",
          "type": "arrow"
        },
        {
          "id": "4-az5zin-O4UtcuNTg_Ar",
          "type": "arrow"
        }
      ],
      "updated": 1760856696760,
      "link": null,
      "locked": false
    },
    {
      "id": "YgAK20hl-o_MqoHzvB9AR",
      "type": "text",
      "x": 3929.2159406873907,
      "y": 3221.6482155209505,
      "width": 325.6597595214844,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1h",
      "roundness": null,
      "seed": 61197862,
      "version": 41,
      "versionNonce": 1816378214,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856557890,
      "link": null,
      "locked": false,
      "text": "Post service (fetch post details)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "cisq4tfZBWsQYV0yJnxMb",
      "originalText": "Post service (fetch post details)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "NO_a-fe_ok6Pac4d5OuOS",
      "type": "rectangle",
      "x": 4452.786685519748,
      "y": 3134.8890297299354,
      "width": 412.59256998697856,
      "height": 186.66661580403616,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1i",
      "roundness": {
        "type": 3
      },
      "seed": 323775782,
      "version": 44,
      "versionNonce": 2110453606,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "J8o84YFVTA_ngkMUY9zFZ"
        },
        {
          "id": "nS6KJEsissFUmU9FQP6lz",
          "type": "arrow"
        },
        {
          "id": "sXPO5aYWvtaS9ZkPJaySR",
          "type": "arrow"
        }
      ],
      "updated": 1760856683012,
      "link": null,
      "locked": false
    },
    {
      "id": "J8o84YFVTA_ngkMUY9zFZ",
      "type": "text",
      "x": 4471.753106011284,
      "y": 3215.7223376319535,
      "width": 374.65972900390625,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1iV",
      "roundness": null,
      "seed": 514815354,
      "version": 41,
      "versionNonce": 429913146,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856586786,
      "link": null,
      "locked": false,
      "text": "Post DB (postgres with read replicas)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "NO_a-fe_ok6Pac4d5OuOS",
      "originalText": "Post DB (postgres with read replicas)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "obfscVG3vV2_59MTz_8V1",
      "type": "rectangle",
      "x": 3912.045820448133,
      "y": 3474.1482155209505,
      "width": 389.6296183268232,
      "height": 205.9259033203125,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1k",
      "roundness": {
        "type": 3
      },
      "seed": 329163494,
      "version": 35,
      "versionNonce": 1232537722,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "AxEcCdfVsk2uusT-zM74N"
        },
        {
          "id": "ossXlN7DbWUQRmP1m1ycN",
          "type": "arrow"
        },
        {
          "id": "OXibScUzKSGiopLgLD-R-",
          "type": "arrow"
        }
      ],
      "updated": 1760856691884,
      "link": null,
      "locked": false
    },
    {
      "id": "AxEcCdfVsk2uusT-zM74N",
      "type": "text",
      "x": 3940.9707522922085,
      "y": 3564.611167181107,
      "width": 331.7797546386719,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1kV",
      "roundness": null,
      "seed": 593022822,
      "version": 45,
      "versionNonce": 1158140326,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856609410,
      "link": null,
      "locked": false,
      "text": "Graph service (fetch follower list)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "obfscVG3vV2_59MTz_8V1",
      "originalText": "Graph service (fetch follower list)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "n8y0b7u-yI4md3ZYjtqZi",
      "type": "rectangle",
      "x": 4476.490298800998,
      "y": 3486.74078550793,
      "width": 418.51847330729106,
      "height": 197.03704833984375,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1m",
      "roundness": {
        "type": 3
      },
      "seed": 1121836346,
      "version": 29,
      "versionNonce": 538358266,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "8LzoR9Htv2Cc51j9WGaFF"
        },
        {
          "id": "OXibScUzKSGiopLgLD-R-",
          "type": "arrow"
        }
      ],
      "updated": 1760856691885,
      "link": null,
      "locked": false
    },
    {
      "id": "8LzoR9Htv2Cc51j9WGaFF",
      "type": "text",
      "x": 4484.919701470269,
      "y": 3560.259309677852,
      "width": 401.65966796875,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1n",
      "roundness": null,
      "seed": 1910450490,
      "version": 98,
      "versionNonce": 1788970022,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760858838782,
      "link": null,
      "locked": false,
      "text": "Redis + Cassandra (not graph DB cuz we\ndont need complex queries)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "n8y0b7u-yI4md3ZYjtqZi",
      "originalText": "Redis + Cassandra (not graph DB cuz we dont need complex queries)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "QLygTLJY4fXj02aTWXHBw",
      "type": "rectangle",
      "x": 3923.156965467664,
      "y": 3806.740785507929,
      "width": 384.44437662760447,
      "height": 208.148193359375,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1o",
      "roundness": {
        "type": 3
      },
      "seed": 844462714,
      "version": 27,
      "versionNonce": 2011032998,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "tjnB2heDMtCwqcJQXZnNa"
        },
        {
          "id": "4-az5zin-O4UtcuNTg_Ar",
          "type": "arrow"
        }
      ],
      "updated": 1760856696760,
      "link": null,
      "locked": false
    },
    {
      "id": "tjnB2heDMtCwqcJQXZnNa",
      "type": "text",
      "x": 3950.149295383029,
      "y": 3898.3148821876166,
      "width": 330.459716796875,
      "height": 25,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1p",
      "roundness": null,
      "seed": 1042943418,
      "version": 48,
      "versionNonce": 2042669690,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856642514,
      "link": null,
      "locked": false,
      "text": "Ranking service (sort/rank posts)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "QLygTLJY4fXj02aTWXHBw",
      "originalText": "Ranking service (sort/rank posts)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "QAOqbBOPUjHDBtrgVUFUt",
      "type": "arrow",
      "x": 2237.231062147351,
      "y": 2920.0741188412635,
      "width": 168.14814249674464,
      "height": 257.03704833984375,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1q",
      "roundness": {
        "type": 2
      },
      "seed": 2071413946,
      "version": 24,
      "versionNonce": 1976878630,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856666002,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          168.14814249674464,
          -257.03704833984375
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "2LqAZreRDUPZv7JNtBJDA",
        "focus": 0.7505555134108485,
        "gap": 17.037150065104015
      },
      "endBinding": {
        "elementId": "IC2aNLc7Y0ciF-8N_sndR",
        "focus": 0.7551268968504216,
        "gap": 13.33328247070358
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "zBNo49QSXZeAQp9yN290P",
      "type": "arrow",
      "x": 2811.3051588270387,
      "y": 2930.1258292966127,
      "width": 70.37038167317723,
      "height": 0.640070404781909,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1s",
      "roundness": {
        "type": 2
      },
      "seed": 1711027578,
      "version": 130,
      "versionNonce": 818984806,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857595853,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          70.37038167317723,
          0.640070404781909
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "ByYSlBN23UZUHOH_fbMmb",
        "focus": 0.0684199444908768,
        "gap": 12.59267171223928
      },
      "endBinding": {
        "elementId": "zpJ2kHDmeOu0Nh-3ex0vf",
        "focus": -0.10714703368424223,
        "gap": 20.740661621094205
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "Q-OfrpPXFoH5jY4dwy3KT",
      "type": "arrow",
      "x": 3236.490298800997,
      "y": 2936.3704038347532,
      "width": 121.48152669270803,
      "height": 2.222239176432595,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1t",
      "roundness": {
        "type": 2
      },
      "seed": 649773626,
      "version": 15,
      "versionNonce": 1449414906,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856672293,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          121.48152669270803,
          -2.222239176432595
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "zpJ2kHDmeOu0Nh-3ex0vf",
        "focus": 0.17887371947292907,
        "gap": 10.370483398437045
      },
      "endBinding": {
        "elementId": "bzz2224X2m81YmG_zyJCW",
        "focus": -0.10426088565954775,
        "gap": 5.9259033203125
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "g279sY8aaAN5fqqp_hrqg",
      "type": "arrow",
      "x": 3724.638492160372,
      "y": 2932.6666888282425,
      "width": 142.2222900390625,
      "height": 1.481475830078125,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1u",
      "roundness": {
        "type": 2
      },
      "seed": 1084583270,
      "version": 27,
      "versionNonce": 1775539750,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856674763,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          142.2222900390625,
          -1.481475830078125
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "bzz2224X2m81YmG_zyJCW",
        "focus": 0.14513907383063232,
        "gap": 14.81475830078125
      },
      "endBinding": {
        "elementId": "jMFH4wi_djHRzAUCTJpZT",
        "focus": -0.1418382568171451,
        "gap": 14.07399495442769
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "DAM-oFGJuzGIT8jh7KczK",
      "type": "arrow",
      "x": 3730.5643954806847,
      "y": 2951.925976344519,
      "width": 160.74076334635402,
      "height": 254.07404581705714,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1v",
      "roundness": {
        "type": 2
      },
      "seed": 1949211002,
      "version": 27,
      "versionNonce": 320670906,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856677994,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          160.74076334635402,
          254.07404581705714
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "bzz2224X2m81YmG_zyJCW",
        "focus": -0.7500565869042115,
        "gap": 20.74066162109375
      },
      "endBinding": {
        "elementId": "cisq4tfZBWsQYV0yJnxMb",
        "focus": -0.7181598238534227,
        "gap": 7.407328287761175
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "nS6KJEsissFUmU9FQP6lz",
      "type": "arrow",
      "x": 4583.156965467664,
      "y": 3117.111116318477,
      "width": 297.7777099609375,
      "height": 181.48147583007812,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1w",
      "roundness": {
        "type": 2
      },
      "seed": 900216230,
      "version": 31,
      "versionNonce": 1324156134,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856680439,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          -297.7777099609375,
          -181.48147583007812
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "NO_a-fe_ok6Pac4d5OuOS",
        "focus": 0.2959808042411887,
        "gap": 17.777913411458485
      },
      "endBinding": {
        "elementId": "jMFH4wi_djHRzAUCTJpZT",
        "focus": -0.5346317064524736,
        "gap": 22.22239176432322
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "sXPO5aYWvtaS9ZkPJaySR",
      "type": "arrow",
      "x": 4306.12001885308,
      "y": 3232.6666888282425,
      "width": 134.0740966796875,
      "height": 2.222188313802235,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1x",
      "roundness": {
        "type": 2
      },
      "seed": 617846650,
      "version": 22,
      "versionNonce": 452946982,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856683012,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          134.0740966796875,
          2.222188313802235
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "cisq4tfZBWsQYV0yJnxMb",
        "focus": -0.05017552324929427,
        "gap": 20.74086507161428
      },
      "endBinding": {
        "elementId": "NO_a-fe_ok6Pac4d5OuOS",
        "focus": -0.10640006569334969,
        "gap": 12.59256998698038
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "ossXlN7DbWUQRmP1m1ycN",
      "type": "arrow",
      "x": 4088.342105441622,
      "y": 3346.74078550793,
      "width": 0.7407633463544698,
      "height": 108.88885498046875,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1y",
      "roundness": {
        "type": 2
      },
      "seed": 1945658234,
      "version": 22,
      "versionNonce": 328163366,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856688539,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          0.7407633463544698,
          108.88885498046875
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "cisq4tfZBWsQYV0yJnxMb",
        "focus": 0.023040334737136552,
        "gap": 15.555572509765625
      },
      "endBinding": {
        "elementId": "obfscVG3vV2_59MTz_8V1",
        "focus": -0.08670080529567882,
        "gap": 18.51857503255178
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "OXibScUzKSGiopLgLD-R-",
      "type": "arrow",
      "x": 4309.82363213433,
      "y": 3597.8519305274613,
      "width": 140.74076334635447,
      "height": 2.96295166015625,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b1z",
      "roundness": {
        "type": 2
      },
      "seed": 2047160186,
      "version": 23,
      "versionNonce": 1161029946,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856691885,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          140.74076334635447,
          2.96295166015625
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "obfscVG3vV2_59MTz_8V1",
        "focus": 0.15381294281326754,
        "gap": 8.14819335937409
      },
      "endBinding": {
        "elementId": "n8y0b7u-yI4md3ZYjtqZi",
        "focus": -0.19924241236687468,
        "gap": 25.92590332031341
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "4-az5zin-O4UtcuNTg_Ar",
      "type": "arrow",
      "x": 4032.786685519747,
      "y": 3353.4074521745965,
      "width": 11.11104329427053,
      "height": 434.81475830078125,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b20",
      "roundness": {
        "type": 2
      },
      "seed": 441520422,
      "version": 47,
      "versionNonce": 398731878,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760856696760,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          11.11104329427053,
          434.81475830078125
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "cisq4tfZBWsQYV0yJnxMb",
        "focus": 0.3181945878122519,
        "gap": 22.22223917643214
      },
      "endBinding": {
        "elementId": "QLygTLJY4fXj02aTWXHBw",
        "focus": -0.35071928539985525,
        "gap": 18.518575032551325
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "s9HCnngpEYn2RjcnSwETY",
      "type": "rectangle",
      "x": 1927.60164727105,
      "y": 3237.8517779395706,
      "width": 316.2963867187498,
      "height": 230.37027994791652,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b22",
      "roundness": {
        "type": 3
      },
      "seed": 117826042,
      "version": 46,
      "versionNonce": 482919270,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "YkvqHHm9tkKUULZq67D-m"
        },
        {
          "id": "tz-3Ri3riqnt6ftkoAoYg",
          "type": "arrow"
        },
        {
          "id": "pfs2ziBD1AdyFNPFgr5MA",
          "type": "arrow"
        }
      ],
      "updated": 1760857138703,
      "link": null,
      "locked": false
    },
    {
      "id": "YkvqHHm9tkKUULZq67D-m",
      "type": "text",
      "x": 1942.3699578179248,
      "y": 3328.0369179135287,
      "width": 286.759765625,
      "height": 50,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b23",
      "roundness": null,
      "seed": 1061806330,
      "version": 75,
      "versionNonce": 1861966202,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857132683,
      "link": null,
      "locked": false,
      "text": "User service (for login/signup\nthat gives JWT token)",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "s9HCnngpEYn2RjcnSwETY",
      "originalText": "User service (for login/signup that gives JWT token)",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "tz-3Ri3riqnt6ftkoAoYg",
      "type": "arrow",
      "x": 2034.2683139377166,
      "y": 3039.3332029070184,
      "width": 0.7407633463542425,
      "height": 177.03704833984375,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b24",
      "roundness": {
        "type": 2
      },
      "seed": 1185627750,
      "version": 27,
      "versionNonce": 436111142,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857136597,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          0.7407633463542425,
          177.03704833984375
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "2LqAZreRDUPZv7JNtBJDA",
        "focus": 0.22684689619814016,
        "gap": 9.629414876303144
      },
      "endBinding": {
        "elementId": "s9HCnngpEYn2RjcnSwETY",
        "focus": -0.3162634438503022,
        "gap": 21.481526692708485
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "pfs2ziBD1AdyFNPFgr5MA",
      "type": "arrow",
      "x": 2072.046227349175,
      "y": 3225.259106227331,
      "width": 5.185343424479015,
      "height": 187.40737915039062,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b25",
      "roundness": {
        "type": 2
      },
      "seed": 1290311802,
      "version": 34,
      "versionNonce": 48719526,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857138703,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          -5.185343424479015,
          -187.40737915039062
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "s9HCnngpEYn2RjcnSwETY",
        "focus": -0.0630249839120718,
        "gap": 12.592671712239735
      },
      "endBinding": {
        "elementId": "2LqAZreRDUPZv7JNtBJDA",
        "focus": 0.02944705054541037,
        "gap": 8.14793904622502
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "N7o8atMO5YB9eVsriS2HO",
      "type": "rectangle",
      "x": 2386.8610873752164,
      "y": 3131.9259000505726,
      "width": 280,
      "height": 191.851806640625,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b26",
      "roundness": {
        "type": 3
      },
      "seed": 72584442,
      "version": 42,
      "versionNonce": 469888250,
      "isDeleted": false,
      "boundElements": [
        {
          "type": "text",
          "id": "BjvEOwpTRMRLV9Uun6PhZ"
        },
        {
          "id": "-T-r4Q-0Q8WT6613GsQfS",
          "type": "arrow"
        },
        {
          "id": "_IbxMmcmEhr_8xcA6i61O",
          "type": "arrow"
        }
      ],
      "updated": 1760857638316,
      "link": null,
      "locked": false
    },
    {
      "id": "BjvEOwpTRMRLV9Uun6PhZ",
      "type": "text",
      "x": 2398.1611667209195,
      "y": 3190.351803370885,
      "width": 257.39984130859375,
      "height": 75,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b27",
      "roundness": null,
      "seed": 42521978,
      "version": 67,
      "versionNonce": 2084075642,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857623616,
      "link": null,
      "locked": false,
      "text": "Route 53/Cloudflare (DNS\nResolution with\ngeographical Routing) ",
      "fontSize": 20,
      "fontFamily": 5,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "N7o8atMO5YB9eVsriS2HO",
      "originalText": "Route 53/Cloudflare (DNS Resolution with geographical Routing) ",
      "autoResize": true,
      "lineHeight": 1.25
    },
    {
      "id": "-T-r4Q-0Q8WT6613GsQfS",
      "type": "arrow",
      "x": 2241.675947401258,
      "y": 2985.9999458676302,
      "width": 122.22218831380223,
      "height": 213.33333333333303,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b28",
      "roundness": {
        "type": 2
      },
      "seed": 259067046,
      "version": 29,
      "versionNonce": 1617952934,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857636427,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          122.22218831380223,
          213.33333333333303
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "2LqAZreRDUPZv7JNtBJDA",
        "focus": -0.6610826417740744,
        "gap": 21.48203531901072
      },
      "endBinding": {
        "elementId": "N7o8atMO5YB9eVsriS2HO",
        "focus": -0.7520828548265261,
        "gap": 22.96295166015625
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    },
    {
      "id": "_IbxMmcmEhr_8xcA6i61O",
      "type": "arrow",
      "x": 2633.527754041883,
      "y": 3117.111040024531,
      "width": 31.11114501953125,
      "height": 79.25928751627589,
      "angle": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeStyle": "solid",
      "roughness": 1,
      "opacity": 100,
      "groupIds": [],
      "frameId": null,
      "index": "b29",
      "roundness": {
        "type": 2
      },
      "seed": 190056186,
      "version": 15,
      "versionNonce": 1039023546,
      "isDeleted": false,
      "boundElements": [],
      "updated": 1760857638316,
      "link": null,
      "locked": false,
      "points": [
        [
          0,
          0
        ],
        [
          31.11114501953125,
          -79.25928751627589
        ]
      ],
      "lastCommittedPoint": null,
      "startBinding": {
        "elementId": "N7o8atMO5YB9eVsriS2HO",
        "focus": 0.35573973775151985,
        "gap": 14.814860026041515
      },
      "endBinding": {
        "elementId": "ByYSlBN23UZUHOH_fbMmb",
        "focus": -0.3373123493495725,
        "gap": 16.29613240560002
      },
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "elbowed": false
    }
  ],
  "appState": {
    "gridSize": 20,
    "gridStep": 5,
    "gridModeEnabled": false,
    "viewBackgroundColor": "#ffffff",
    "lockedMultiSelections": {}
  },
  "files": {}
}
